<!DOCTYPE html>
<html>
<head>
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">

</head>
<body>
<h3>Aplikasi Absensi</h3>
<h4 id="subTitle"></h4>
<button type="button" onclick="submitMurid();">Submit Nama Murid</button>
<button type="button" onclick="absenMurid();">Mulai Absen Murid</button>
<table id="daftarmurid" border="5"></table>
</body>
<script src="jquery.min.js"></script>
<script>
	var currentRow = -1;
	var murid=null;
	var namaMurid = [];
	var absenMurid = {};
	function submitMurid(){
		var murid = {};
		for (var i = 0; i < currentRow; i++){
			//murid[i] = document.getElementById("datamurid"+i);
			var murid =  document.getElementById("datamurid"+i);
			if (murid==null){continue;}
			namaMurid.push(murid.innerHTML);
		}
	}

	function absenMurid(){
		alert("selanjutnya, tekan oke untuk masuk atau cancel untuk tidak masuk");
		var absen = {"":""};
		var tidak_masuk = "";
		
		
		for (var i = 0; i < currentRow; i++){
			//murid[i] = document.getElementById("datamurid"+i);
			var murid =  document.getElementById("datamurid"+i);
			if (murid==null){continue;}
			murid = murid.innerHTML;
			if (confirm(murid + " ?")==true){
				 absen[murid] = "masuk";
			}
			else{

				absen[murid] = prompt("Keterangan "+murid+" tidak masuk: ");
				tidak_masuk+=murid+"\n";
			}
		}
		console.log("Absen tidak masuk: \n\n");
		for (var nama in absen){
			console.log(nama+": "+absen[nama]+"\n");
		}
	}

	function getRowInput(){
		currentRow++; 
		return "<tr id='row"+currentRow+"'><td><input type='text' id='inputmurid"+currentRow+"'/> <button type='button' onclick='tambahMurid()'>Tambah</button> </td></tr>"; 
	}

	function hapusRow(id){
		console.log("rowNow"+id);
		$("#rowNow"+id).remove();
	}

	function editRow(id){
		console.log("edit datamurid"+id);
		var nama = prompt("Edit "+$("#datamurid"+id).html()+" menjadi: ");
		if (nama){
			$("#datamurid"+id).html(nama);	
		}
		
	}

	function tambahMurid(){	
		var rowIndex = currentRow;
		var namaInput = document.getElementById("inputmurid"+rowIndex).value;
		if (namaInput==""){
			if (!confirm("Nama murid kosong? ")){
				return;
			}
		}
		
		murid.innerHTML+= "<tr id='rowNow"+rowIndex+"'><td><p id='datamurid"+rowIndex+"'>"+namaInput+"</p></td><td><button type='button' onclick='hapusRow("+String(rowIndex)+");'>Hapus</button></td><td><button type='button' onclick='editRow("+String(rowIndex)+");'>Edit</button></td></tr>";
		$("#row"+currentRow).remove();
		murid.innerHTML += getRowInput();
	}

	function main(){
		$("#subTitle").html("Mohon masukan daftar murid-murid "+localStorage.kelas);
		murid = document.getElementById("daftarmurid");
		murid.innerHTML += getRowInput();
		alert(cordova.file.dataDirectory);
	}

	main();
	
</script>
</html>